# AI-Powered Survey Web Application

## Overview
This is an advanced survey web application built with Node.js, Express, TypeScript, and Supabase. The application features AI-assisted survey creation, robust authentication, and comprehensive survey management.

## Features
- User Authentication with Supabase
- AI-Powered Survey Question Generation
- Create, Read, Update, and Delete (CRUD) Surveys
- Dynamic Survey Response Collection
- Flexible Question Types
- Input Validation
- Error Handling

## Prerequisites
- Node.js (v18+)
- npm or yarn
- Supabase Account
- OpenAI API Key (optional, for AI features)

## Installation

1. Clone the repository
```bash
git clone https://github.com/yourusername/ai-survey-app.git
cd ai-survey-app
```

2. Install dependencies
```bash
npm install
```

3. Configure Environment Variables
Create a `.env` file in the root directory with the following:
```
SUPABASE_URL=your_supabase_project_url
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
OPENAI_API_KEY=your_openai_api_key
JWT_SECRET=your_jwt_secret
PORT=3000
```

## Supabase Database Schema

### Tables to Create

1. `users`
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  username TEXT UNIQUE,
  email TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

2. `surveys`
```sql
CREATE TABLE surveys (
  id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  title TEXT NOT NULL,
  description TEXT,
  creator_id UUID REFERENCES users(id),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

3. `questions`
```sql
CREATE TABLE questions (
  id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  survey_id BIGINT REFERENCES surveys(id) ON DELETE CASCADE,
  question_text TEXT NOT NULL,
  question_type TEXT NOT NULL CHECK (
    question_type IN ('multiple_choice', 'single_choice', 'text', 'rating')
  )
);
```

4. `options`
```sql
CREATE TABLE options (
  id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  question_id BIGINT REFERENCES questions(id) ON DELETE CASCADE,
  option_text TEXT NOT NULL
);
```

5. `responses`
```sql
CREATE TABLE responses (
  id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  survey_id BIGINT REFERENCES surveys(id) ON DELETE CASCADE,
  user_id UUID REFERENCES users(id),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

6. `answer_choices`
```sql
CREATE TABLE answer_choices (
  id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  response_id BIGINT REFERENCES responses(id) ON DELETE CASCADE,
  question_id BIGINT REFERENCES questions(id) ON DELETE CASCADE,
  option_id BIGINT REFERENCES options(id),
  text_answer TEXT
);
```

## Running the Application

### Development Mode
```bash
npm run dev
```

### Production Build
```bash
npm run build
npm start
```

## Testing
```bash
npm test
```

## API Endpoints

### Authentication
- `POST /auth/signup` - Register a new user
- `POST /auth/login` - User login
- `POST /auth/logout` - User logout

### Surveys
- `POST /api/surveys` - Create a new survey
- `GET /api/surveys` - Get all surveys
- `GET /api/surveys/:id` - Get a specific survey
- `PUT /api/surveys/:id` - Update a survey
- `DELETE /api/surveys/:id` - Delete a survey
- `POST /api/surveys/:id/submit` - Submit survey responses

### AI Survey Generation
- `POST /api/surveys/ai/generate-questions` - Generate AI survey questions

## Error Handling
The application provides comprehensive error handling with meaningful error messages and appropriate HTTP status codes.

## Security Considerations
- Password hashing
- JWT-based authentication
- Input validation
- Protection against common web vulnerabilities

## Contributing
1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## License
Distributed under the MIT License. See `LICENSE` for more information.

## Contact
Your Name - your.email@example.com

Project Link: [https://github.com/yourusername/ai-survey-app](https://github.com/yourusername/ai-survey-app)
```

## Acknowledgements
- [Supabase](https://supabase.com/)
- [OpenAI](https://openai.com/)
- [Node.js](https://nodejs.org/)
- [Express](https://expressjs.com/)
- [TypeScript](https://www.typescriptlang.org/)